

<details>

<summary><strong>–í–∏–≤—á–∞–π—Ç–µ –º–µ—Ç–æ–¥–∏ –∑–ª–∞–º—É AWS –∑ –Ω—É–ª—è —Ç–∞ —Å—Ç–∞–Ω—å—Ç–µ –µ–∫—Å–ø–µ—Ä—Ç–æ–º –∑ –∫—É—Ä—Å–æ–º</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

* –í–∏ –ø—Ä–∞—Ü—é—î—Ç–µ –≤ **–∫–æ–º–ø–∞–Ω—ñ—ó –∑ –∫—ñ–±–µ—Ä–±–µ–∑–ø–µ–∫–∏**? –•–æ—á–µ—Ç–µ –±–∞—á–∏—Ç–∏ **—Ä–µ–∫–ª–∞–º—É —Å–≤–æ—î—ó –∫–æ–º–ø–∞–Ω—ñ—ó –Ω–∞ HackTricks**? —á–∏ —Ö–æ—á–µ—Ç–µ –æ—Ç—Ä–∏–º–∞—Ç–∏ –¥–æ—Å—Ç—É–ø –¥–æ **–æ—Å—Ç–∞–Ω–Ω—å–æ—ó –≤–µ—Ä—Å—ñ—ó PEASS –∞–±–æ –∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ HackTricks —É —Ñ–æ—Ä–º–∞—Ç—ñ PDF**? –û–∑–Ω–∞–π–æ–º—Ç–µ—Å—è –∑ [**–ü–õ–ê–ù–ê–ú–ò –ü–ï–†–ï–î–ü–õ–ê–¢–ò**](https://github.com/sponsors/carlospolop)!
* –í—ñ–¥–∫—Ä–∏–π—Ç–µ –¥–ª—è —Å–µ–±–µ –µ–∫—Å–∫–ª—é–∑–∏–≤–Ω—ñ [NFT](https://opensea.io/collection/the-peass-family) –∑ –Ω–∞—à–æ—ó –∫–æ–ª–µ–∫—Ü—ñ—ó [**The PEASS Family**](https://opensea.io/collection/the-peass-family)
* –û—Ç—Ä–∏–º–∞–π—Ç–µ –æ—Ñ—ñ—Ü—ñ–π–Ω–∏–π [**PEASS & HackTricks swag**](https://peass.creator-spring.com)
* **–ü—Ä–∏—î–¥–Ω—É–π—Ç–µ—Å—è –¥–æ [**üí¨**](https://emojipedia.org/speech-balloon/) [**Discord –≥—Ä—É–ø–∏**](https://discord.gg/hRep4RUj7f) –∞–±–æ [**telegram –∫–∞–Ω–∞–ª—É**](https://t.me/peass) —á–∏ **–ø—ñ–¥–ø–∏—Å—É–π—Ç–µ—Å—å** –Ω–∞ –º–µ–Ω–µ –≤ **Twitter** üê¶[**@carlospolopm**](https://twitter.com/hacktricks_live)**.
* **–ü–æ–¥—ñ–ª—ñ—Ç—å—Å—è –≤–∞—à–∏–º–∏ —Ö–∞–∫–µ—Ä—Å—å–∫–∏–º–∏ —Ñ—ñ—à–∫–∞–º–∏, –Ω–∞–¥—ñ—Å–ª–∞–≤—à–∏ Pull Request –¥–æ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—é [hacktricks](https://github.com/carlospolop/hacktricks) –∞–±–æ [hacktricks-cloud](https://github.com/carlospolop/hacktricks-cloud)**.

</details>


# CBC

–Ø–∫—â–æ —Ñ–∞–π–ª **–∫—É–∫—ñ (cookie)** –º—ñ—Å—Ç–∏—Ç—å **–ª–∏—à–µ —ñ–º'—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ (username)** (–∞–±–æ –ø–µ—Ä—à–∞ —á–∞—Å—Ç–∏–Ω–∞ —Ñ–∞–π–ª—É cookie —î —é–∑–µ—Ä–Ω–µ–π–º–æ–º) —ñ –≤–∏ —Ö–æ—á–µ—Ç–µ –≤–∏–¥–∞—Ç–∏ —Å–µ–±–µ –∑–∞ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –ø—ñ–¥ —ñ–º–µ–Ω–µ–º "**admin**", —Ç–æ –≤–∏ –º–æ–∂–µ—Ç–µ —Å—Ç–≤–æ—Ä–∏—Ç–∏ –Ω–æ–≤–æ–≥–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –∑ —ñ–º'—è–º "**bdmin**" —ñ **–ø—ñ–¥—ñ–±—Ä–∞—Ç–∏ –ø–µ—Ä—à–∏–π –±–∞–π—Ç** –∑–Ω–∞—á–µ–Ω–Ω—è –∫—É–∫—ñ.

# CBC-MAC

**–ö–æ–¥ –∞–≤—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å –∑ –ª–∞–Ω—Ü—é–≥–æ–≤–∏–º —à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è–º –±–ª–æ–∫—ñ–≤** (**CBC-MAC**) - —Ü–µ –º–µ—Ç–æ–¥, —â–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –≤ –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ—ñ—ó. –í—ñ–Ω –ø—Ä–∞—Ü—é—î —à–ª—è—Ö–æ–º —à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –±–ª–æ–∫ –∑–∞ –±–ª–æ–∫–æ–º, –¥–µ —à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è –∫–æ–∂–Ω–æ–≥–æ –±–ª–æ–∫—É –ø–æ–≤'—è–∑–∞–Ω–µ –∑ –ø–æ–ø–µ—Ä–µ–¥–Ω—ñ–º. –¶–µ–π –ø—Ä–æ—Ü–µ—Å —Å—Ç–≤–æ—Ä—é—î –ª–∞–Ω—Ü—é–≥ –±–ª–æ–∫—ñ–≤, –≥–∞—Ä–∞–Ω—Ç—É—é—á–∏, —â–æ –∑–º—ñ–Ω–∞ –Ω–∞–≤—ñ—Ç—å –æ–¥–Ω–æ–≥–æ –±—ñ—Ç–∞ –≤ –æ—Ä–∏–≥—ñ–Ω–∞–ª—å–Ω–æ–º—É –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—ñ –ø—Ä–∏–∑–≤–µ–¥–µ –¥–æ –Ω–µ–ø–µ—Ä–µ–¥–±–∞—á—É–≤–∞–Ω–æ—ó –∑–º—ñ–Ω–∏ –≤ –æ—Å—Ç–∞–Ω–Ω—å–æ–º—É –±–ª–æ–∫—É –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—Ö –¥–∞–Ω–∏—Ö. –î–ª—è –≤–Ω–µ—Å–µ–Ω–Ω—è –∞–±–æ –≤—ñ–¥–º—ñ–Ω–∏ —Ç–∞–∫–æ—ó –∑–º—ñ–Ω–∏ –ø–æ—Ç—Ä—ñ–±–µ–Ω –∫–ª—é—á —à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è, —â–æ –∑–∞–±–µ–∑–ø–µ—á—É—î –∑–∞—Ö–∏—Å—Ç.

–î–ª—è –æ–±—á–∏—Å–ª–µ–Ω–Ω—è CBC-MAC –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è m —à–∏—Ñ—Ä—É—î—Ç—å—Å—è –≤ —Ä–µ–∂–∏–º—ñ CBC –∑ –Ω—É–ª—å–æ–≤–∏–º IV (–≤–µ–∫—Ç–æ—Ä–æ–º —ñ–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—ó) —ñ –∑–±–µ—Ä—ñ–≥–∞—é—Ç—å –æ—Å—Ç–∞–Ω–Ω—ñ–π –±–ª–æ–∫. –ù–∞ –Ω–∞—Å—Ç—É–ø–Ω–æ–º—É —Ä–∏—Å—É–Ω–∫—É –ø–æ–∫–∞–∑–∞–Ω–æ –æ–±—á–∏—Å–ª–µ–Ω–Ω—è CBC-MAC –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è, —â–æ —Å–∫–ª–∞–¥–∞—î—Ç—å—Å—è –∑ –±–ª–æ–∫—ñ–≤![https://wikimedia.org/api/rest\_v1/media/math/render/svg/bbafe7330a5e40a04f01cc776c9d94fe914b17f5](https://wikimedia.org/api/rest\_v1/media/math/render/svg/bbafe7330a5e40a04f01cc776c9d94fe914b17f5), –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é —Å–µ–∫—Ä–µ—Ç–Ω–æ–≥–æ –∫–ª—é—á–∞ k —ñ –±–ª–æ–∫–æ–≤–æ–≥–æ —à–∏—Ñ—Ä—É E:

![https://upload.wikimedia.org/wikipedia/commons/thumb/b/bf/CBC-MAC\_structure\_\(en\).svg/570px-CBC-MAC\_structure\_\(en\).svg.png](https://upload.wikimedia.org/wikipedia/commons/thumb/b/bf/CBC-MAC\_structure\_\(en\).svg/570px-CBC-MAC\_structure\_\(en\).svg.png)

# Vulnerability

–ó–∞–∑–≤–∏—á–∞–π –¥–ª—è CBC-MAC –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å **IV**, —â–æ **–¥–æ—Ä—ñ–≤–Ω—é—î 0**.\
–¶–µ –ø—Ä–æ–±–ª–µ–º–∞, —Ç–æ–º—É —â–æ 2 –≤—ñ–¥–æ–º—ñ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è (`m1` —ñ `m2`) –Ω–µ–∑–∞–ª–µ–∂–Ω–æ —Å—Ç–≤–æ—Ä—è—Ç—å 2 –ø—ñ–¥–ø–∏—Å–∏ (`s1` —ñ `s2`). –û—Ç–∂–µ:

* `E(m1 XOR 0) = s1`
* `E(m2 XOR 0) = s2`

–¢–æ–¥—ñ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è, —Å–∫–ª–∞–¥–µ–Ω–µ –∑ m1 —ñ m2 (m3), —Å—Ç–≤–æ—Ä–∏—Ç—å 2 –ø—ñ–¥–ø–∏—Å–∏ (s31 —ñ s32):

* `E(m1 XOR 0) = s31 = s1`
* `E(m2 XOR s1) = s32`

**–©–æ –º–æ–∂–Ω–∞ –æ–±—á–∏—Å–ª–∏—Ç–∏ –±–µ–∑ –∑–Ω–∞–Ω–Ω—è –∫–ª—é—á–∞ —à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è.**

–£—è–≤—ñ—Ç—å, —â–æ –≤–∏ —à–∏—Ñ—Ä—É—î—Ç–µ —ñ–º'—è `Administrator` –±–ª–æ–∫–∞–º–∏ –ø–æ `8 –±–∞–π—Ç`:

* `Administ`
* `rator\00\00\00`

–í–∏ –º–æ–∂–µ—Ç–µ —Å—Ç–≤–æ—Ä–∏—Ç–∏ —ñ–º'—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ **Administ** (m1) —ñ –æ—Ç—Ä–∏–º–∞—Ç–∏ –ø—ñ–¥–ø–∏—Å (s1).\
–ü–æ—Ç—ñ–º –≤–∏ –º–æ–∂–µ—Ç–µ —Å—Ç–≤–æ—Ä–∏—Ç–∏ —ñ–º'—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞, —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–º `rator\00\00\00 XOR s1`. –¶–µ —Å—Ç–≤–æ—Ä–∏—Ç—å `E(m2 XOR s1 XOR 0)`, —â–æ —î s32.\
–¢–µ–ø–µ—Ä –≤–∏ –º–æ–∂–µ—Ç–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ s32 —è–∫ –ø—ñ–¥–ø–∏—Å –ø–æ–≤–Ω–æ–≥–æ —ñ–º–µ–Ω—ñ `Administrator`.

### –ü—ñ–¥—Å—É–º–æ–∫

1. –û—Ç—Ä–∏–º–∞—Ç–∏ –ø—ñ–¥–ø–∏—Å —ñ–º–µ–Ω—ñ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ **Administ** (m1), —â–æ —î s1.
2. –û—Ç—Ä–∏–º–∞—Ç–∏ –ø—ñ–¥–ø–∏—Å —ñ–º–µ–Ω—ñ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ **rator\x00\x00\x00 XOR s1 XOR 0**, —â–æ —î s32.
3. –í—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ –∑–Ω–∞—á–µ–Ω–Ω—è –∫—É–∫—ñ —è–∫ s32, —ñ –≤–æ–Ω–æ –±—É–¥–µ –¥—ñ–π—Å–Ω–∏–º –¥–ª—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ **Administrator**.

# –ê—Ç–∞–∫–∞ –∑ –∫–æ–Ω—Ç—Ä–æ–ª–µ–º IV

–Ø–∫—â–æ –≤–∏ –º–∞—î—Ç–µ –º–æ–∂–ª–∏–≤—ñ—Å—Ç—å –∫–æ–Ω—Ç—Ä–æ–ª—é–≤–∞—Ç–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞–Ω–∏–π IV, –∞—Ç–∞–∫–∞ –º–æ–∂–µ –±—É—Ç–∏ –¥—É–∂–µ –ø—Ä–æ—Å—Ç–æ—é.\
–Ø–∫—â–æ cookie –º—ñ—Å—Ç–∏—Ç—å –ª–∏—à–µ –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–µ —ñ–º'—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞, –≤–∏ –º–æ–∂–µ—Ç–µ —Å—Ç–≤–æ—Ä–∏—Ç–∏ –Ω–æ–≤–æ–≥–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ "**Administrator**" —ñ –æ—Ç—Ä–∏–º–∞—Ç–∏ –π–æ–≥–æ cookie, —â–æ–± –≤–∏–¥–∞—Ç–∏ —Å–µ–±–µ –∑–∞ "**administrator**". –¢–µ–ø–µ—Ä, –∫–æ–Ω—Ç—Ä–æ–ª—é—é—á–∏ IV, –≤–∏ –º–æ–∂–µ—Ç–µ –∑–º—ñ–Ω–∏—Ç–∏ –ø–µ—Ä—à–∏–π –±–∞–π—Ç IV —Ç–∞–∫, —â–æ **IV\[0] XOR "A" == IV'\[0] XOR "a"** —ñ –∑–≥–µ–Ω–µ—Ä—É–≤–∞—Ç–∏ –Ω–æ–≤–µ –∑–Ω–∞—á–µ–Ω–Ω—è cookie –¥–ª—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ "**Administrator**". –¶—ñ cookie –±—É–¥—É—Ç—å –¥—ñ–π—Å–Ω–∏–º–∏ –¥–ª—è **—ñ–º—ñ—Ç–∞—Ü—ñ—ó** –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ **administrator** –∑ –ø–æ—á–∞—Ç–∫–æ–≤–∏–º **IV**.

## –î–∂–µ—Ä–µ–ª–∞

–ë—ñ–ª—å—à–µ –¥–µ—Ç–∞–ª–µ–π –≤ [https://en.wikipedia.org/wiki/CBC-MAC](https://en.wikipedia.org/wiki/CBC-MAC)


<details>

<summary><strong>–í–∏–≤—á–∞–π—Ç–µ –º–µ—Ç–æ–¥–∏ –∑–ª–∞–º—É AWS –∑ –Ω—É–ª—è —Ç–∞ —Å—Ç–∞–Ω—å—Ç–µ –µ–∫—Å–ø–µ—Ä—Ç–æ–º –∑ –∫—É—Ä—Å–æ–º</strong> <a href="https://training.hacktricks.xyz/courses/arte"><strong>htARTE (HackTricks AWS Red Team Expert)</strong></a><strong>!</strong></summary>

* –í–∏ –ø—Ä–∞—Ü—é—î—Ç–µ –≤ **–∫–æ–º–ø–∞–Ω—ñ—ó –∑ –∫—ñ–±–µ—Ä–±–µ–∑–ø–µ–∫–∏**? –•–æ—á–µ—Ç–µ –±–∞—á–∏—Ç–∏ **—Ä–µ–∫–ª–∞–º—É —Å–≤–æ—î—ó –∫–æ–º–ø–∞–Ω—ñ—ó –Ω–∞ HackTricks**? —á–∏ —Ö–æ—á–µ—Ç–µ –æ—Ç—Ä–∏–º–∞—Ç–∏ –¥–æ—Å—Ç—É–ø –¥–æ **–æ—Å—Ç–∞–Ω–Ω—å–æ—ó –≤–µ—Ä—Å—ñ—ó PEASS –∞–±–æ –∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ HackTricks —É —Ñ–æ—Ä–º–∞—Ç—ñ PDF**? –û–∑–Ω–∞–π–æ–º—Ç–µ—Å—è –∑ [**–ü–õ–ê–ù–ê–ú–ò –ü–ï–†–ï–î–ü–õ–ê–¢–ò**](https://github.com/sponsors/carlospolop)!
* –í—ñ–¥–∫—Ä–∏–π—Ç–µ –¥–ª—è —Å–µ–±–µ –µ–∫—Å–∫–ª—é–∑–∏–≤–Ω—ñ [NFT](https://opensea.io/collection/the-peass-family) –∑ –Ω–∞—à–æ—ó –∫–æ–ª–µ–∫—Ü—ñ—ó [**The PEASS Family**](https://opensea.io/collection/the-peass-family)
* –û—Ç—Ä–∏–º–∞–π—Ç–µ –æ—Ñ—ñ—Ü—ñ–π–Ω–∏–π [**PEASS & HackTricks swag**](https://peass.creator-spring.com)
* **–ü—Ä–∏—î–¥–Ω—É–π—Ç–µ—Å—è –¥–æ [**üí¨**](https://emojipedia.org/speech-balloon/) [**Discord –≥—Ä—É–ø–∏**](https://discord.gg/hRep4RUj7f) –∞–±–æ [**telegram –∫–∞–Ω–∞–ª—É**](https://t.me/peass) —á–∏ **–ø—ñ–¥–ø–∏—Å—É–π—Ç–µ—Å—å** –Ω–∞ –º–µ–Ω–µ –≤ **Twitter** üê¶[**@carlospolopm**](https://twitter.com/hacktricks_live)**.
* **–ü–æ–¥—ñ–ª—ñ—Ç—å—Å—è –≤–∞—à–∏–º–∏ —Ö–∞–∫–µ—Ä—Å—å–∫–∏–º–∏ —Ñ—ñ—à–∫–∞–º–∏, –Ω–∞–¥—ñ—Å–ª–∞–≤—à–∏ Pull Request –¥–æ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—é [hacktricks](https://github.com/carlospolop/hacktricks) –∞–±–æ [hacktricks-cloud](https://github.com/carlospolop/hacktricks-cloud)**.

</details>


